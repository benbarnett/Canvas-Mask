/*************************************************
Canvas Mask Utility v0.1
Author: www.benbarnett.net || @benpbarnett

Copyright (c) 2011 Ben Barnett
Licensed under the MIT license
http://www.opensource.org/licenses/mit-license.php
**************************************************/
function applyCanvasMask(a,g,c,b,l){if(!document.createElement("canvas").getContext)return a;var h=document.createElement("canvas"),d=h.getContext("2d"),e=document.createElement("canvas"),j=e.getContext("2d"),f=null,i=null,k=null;h.width=c;h.height=b*2;e.width=c;e.height=b;d.drawImage(a,0,0);d.drawImage(g,0,b);f=d.getImageData(0,0,c,b);i=f.data;k=d.getImageData(0,b,c,b).data;a=3;for(g=i.length;a<g;a+=4)i[a]=k[a];return l?(j.clearRect(0,0,c,b),j.putImageData(f,0,0),e.toDataURL()):f};